{% extends 'app/public/base.html' %}
{% load static %}

{% block title %}{{ item.name }}{% endblock %}

{% block content %}
<div class="container" style="padding: 40px 20px;">

    <div style="margin-bottom: 20px; font-size: 14px; color: #6b7280;">
        <a href="{% url 'product_list' %}" style="text-decoration: none; color: #6b7280;">Products</a> 
        <span style="margin: 0 5px;">/</span> 
        <span style="color: var(--primary-pink); font-weight: 600;">{{ item.name }}</span>
    </div>

    <div style="background: white; border-radius: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.05); padding: 30px; display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-bottom: 50px;">
        
        <div style="position: relative;">
            <div style="width: 100%; aspect-ratio: 1/1; background: #f9fafb; border-radius: 16px; overflow: hidden; border: 1px solid #f3f4f6;">
                {% if item.image %}
                    <img src="{{ item.image.url }}" alt="{{ item.name }}" style="width: 100%; height: 100%; object-fit: cover;">
                {% else %}
                    <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; color: #d1d5db; font-size: 60px;">ðŸ“·</div>
                {% endif %}
            </div>
        </div>

        <div style="display: flex; flex-direction: column;">
            
            <div style="margin-bottom: 10px;">
                <span style="background: #fce7f3; color: #ec4899; padding: 4px 10px; border-radius: 6px; font-size: 12px; font-weight: 700; text-transform: uppercase;">
                    {{ item.category.name }}
                </span>
                {% if item.brand %}
                <span style="margin-left: 10px; font-size: 13px; color: #6b7280; font-weight: 600;">
                    {{ item.brand.name }}
                </span>
                {% endif %}
            </div>

            <h1 style="font-size: 28px; font-weight: 800; color: #1f2937; margin: 0 0 15px 0; line-height: 1.2;">
                {{ item.name }}
            </h1>

            <div style="font-size: 32px; font-weight: 800; color: var(--primary-pink); margin-bottom: 20px;">
                Rp {{ item.price|floatformat:0 }}
            </div>

            <div style="color: #4b5563; line-height: 1.6; margin-bottom: 30px; font-size: 15px;">
                {{ item.description|linebreaks }}
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 30px; background: #f9fafb; padding: 20px; border-radius: 12px;">
                <div>
                    <span style="display: block; font-size: 12px; color: #9ca3af; margin-bottom: 2px;">Color</span>
                    <span style="font-weight: 600; color: #374151;">{{ item.color|default:"-" }}</span>
                </div>
                <div>
                    <span style="display: block; font-size: 12px; color: #9ca3af; margin-bottom: 2px;">Size</span>
                    <span style="font-weight: 600; color: #374151;">{{ item.size|default:"-" }}</span>
                </div>
                <div>
                    <span style="display: block; font-size: 12px; color: #9ca3af; margin-bottom: 2px;">Stock</span>
                    {% if item.stock > 0 %}
                        <span style="font-weight: 600; color: #059669;">{{ item.stock }} Available</span>
                    {% else %}
                        <span style="font-weight: 600; color: #dc2626;">Out of Stock</span>
                    {% endif %}
                </div>
            </div>

            <div style="margin-top: auto;">
                {% if item.stock > 0 %}
                <form action="{% url 'add_to_cart' item.id %}" method="POST" style="display: flex; gap: 15px; align-items: stretch;">
                    {% csrf_token %}
                    <input type="hidden" name="next" value="{{ request.path }}">

                    <div style="position: relative; width: 100px;">
                        <input type="number" name="quantity" value="1" min="1" max="{{ item.stock }}" 
                               style="width: 100%; height: 50px; padding: 0 15px; border: 1px solid #d1d5db; border-radius: 10px; font-weight: 700; font-size: 16px; outline: none; text-align: center;">
                        <span style="position: absolute; right: 10px; top: 15px; font-size: 10px; color: #9ca3af; pointer-events: none;">QTY</span>
                    </div>

                    <button type="submit" class="btn btn-primary" style="flex: 1; height: 50px; font-size: 16px; border-radius: 10px; display: flex; align-items: center; justify-content: center; gap: 10px; box-shadow: 0 4px 15px rgba(255, 105, 180, 0.3);">
                        ðŸ›’ Add to Cart
                    </button>
                </form>
                {% else %}
                    <button disabled style="width: 100%; height: 50px; background: #e5e7eb; color: #9ca3af; border: none; border-radius: 10px; font-weight: 600; cursor: not-allowed;">
                        Out of Stock
                    </button>
                {% endif %}
            </div>

        </div>
    </div>

    {% if related_items %}
    <div>
        <h3 style="font-size: 20px; font-weight: 700; color: #1f2937; margin-bottom: 20px;">Related Products</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px;">
            {% for rel in related_items %}
            <div class="product-card" style="background: white; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.03); transition: transform 0.2s; border: 1px solid #f3f4f6; display: flex; flex-direction: column;">
                
                <a href="{% url 'product_detail' rel.id %}" style="display: block; aspect-ratio: 1/1; overflow: hidden; background: #f9fafb;">
                    {% if rel.image %}
                        <img src="{{ rel.image.url }}" alt="{{ rel.name }}" style="width: 100%; height: 100%; object-fit: cover;">
                    {% else %}
                        <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; color: #d1d5db;">ðŸ“·</div>
                    {% endif %}
                </a>

                <div style="padding: 15px; display: flex; flex-direction: column; flex-grow: 1;">
                    <h4 style="font-size: 14px; font-weight: 700; margin: 0 0 5px 0;">
                        <a href="{% url 'product_detail' rel.id %}" style="text-decoration: none; color: #1f2937;">{{ rel.name }}</a>
                    </h4>
                    <div style="font-size: 14px; font-weight: 700; color: var(--primary-pink); margin-top: auto;">
                        Rp {{ rel.price|floatformat:0 }}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

</div>

<style>
    @media (max-width: 768px) {
        div[style*="grid-template-columns: 1fr 1fr"] {
            grid-template-columns: 1fr !important; /* Stack vertically on mobile */
        }
    }
</style>
{% endblock %}